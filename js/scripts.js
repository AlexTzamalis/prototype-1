// Αρχείο JavaScript για το University of Larissa

// Αυτό το αρχείο περιέχει όλο τον κώδικα JavaScript που χρησιμοποιείται
// στις διάφορες σελίδες του site. Εδώ βρίσκονται όλες οι λειτουργίες
// που κάνουν την ιστοσελίδα διαδραστική (interactive).


// ΛΕΙΤΟΥΡΓΙΑ: ΔΗΜΙΟΥΡΓΙΑ ΧΑΡΤΗ
// Αυτή η συνάρτηση δημιουργεί έναν χάρτη που δείχνει την τοποθεσία
// του πανεπιστημίου. Χρησιμοποιεί τη βιβλιοθήκη Leaflet για να
// εμφανίσει τον χάρτη στην αρχική σελίδα.
//
// Λειτουργια:
// 1. Ελέγχει αν υπάρχει το κουτίόπου θα μπει ο χάρτης
// 2. Περιμένει να φορτωθεί όλη η σελίδα
// 3. Δημιουργεί τον χάρτη με τις συντεταγμένες του πανεπιστημίου
// 4. Προσθέτει έναν δείκτη marker που δείχνει ακριβώς πού είναι το πανεπιστήμιο
function initCampusMap() {
    // Ελέγχουμε αν υπάρχει το στοιχείο με id="campusMap" στη σελίδα
    // Αν δεν υπάρχει, δεν κάνουμε τίποτα (γιατί δεν χρειάζεται χάρτης)
    if (document.getElementById('campusMap')) {
        // Περιμένουμε να φορτωθεί όλη η σελίδα πριν δημιουργήσουμε τον χάρτη
        window.addEventListener('load', function() {
            // Δημιουργούμε τον χάρτη
            var map = L.map('campusMap').setView([39.6370, 22.4201], 16);

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors'  // Αυτό δείχνει από πού είναι ο χάρτης
            }).addTo(map);
            
            // Προσθέτουμε έναν δείκτη (marker) στον χάρτη
            // Ο δείκτης δείχνει ακριβώς πού βρίσκεται το πανεπιστήμιο
            L.marker([39.6370, 22.4201]).addTo(map)
                // bindPopup() προσθέτει ένα μικρό παράθυρο που εμφανίζεται όταν κάνεις κλικ στον δείκτη
                .bindPopup('<b>University of Larissa</b><br>Παπαναστασίου 28, Λάρισα')
                // openPopup() ανοίγει αυτόματα το παράθυρο όταν φορτώνει η σελίδα
                .openPopup();

            // και μετά ανανεώνουμε το μέγεθος του χάρτη
            // Αυτό βεβαιώνει ότι ο χάρτης θα φαίνεται σωστά
            setTimeout(function() {
                map.invalidateSize();  // Αυτή η εντολή ανανεώνει το μέγεθος του χάρτη
            }, 100);
        });
    }
}

// ΛΕΙΤΟΥΡΓΙΑ: ΑΛΛΑΓΗ ΚΑΡΤΕΛΩΝ (TABS)

// Αυτή η συνάρτηση χειρίζεται την αλλαγή μεταξύ των διαφορετικών καρτελών
// (tabs) στις σελίδες dashboard. Για παράδειγμα, όταν ο φοιτητής κάνει
// κλικ στο "Μαθήματα" ή "Βαθμολογίες", αυτή η συνάρτηση αλλάζει ποια
// καρτέλα θα φαίνεται.
//
// Παράμετροι:
// - tabName: Το όνομα της καρτέλας που θέλουμε να δείξουμε (π.χ. 'courses', 'grades')
// - buttonElement: Το κουμπί που πατήθηκε (προαιρετικό - μπορεί να μην δοθεί)
//
// Τι κάνει:
// 1. Κρύβει όλες τις καρτέλες
// 2. Αφαιρεί το "active" από όλα τα κουμπιά
// 3. Εμφανίζει τη καρτέλα που επιλέχθηκε
// 4. Προσθέτει το "active" στο κουμπί που πατήθηκε
// 5. Αλλάζει το URL χωρίς να φορτώνει ξανά τη σελίδα
function showTab(tabName, buttonElement) {
    // ΒΗΜΑ 1: Κρύβουμε όλες τις καρτέλες
    // querySelectorAll() βρίσκει όλα τα στοιχεία που έχουν την κλάση 'tab-content'
    // forEach() κάνει κάτι για κάθε ένα από αυτά
    // classList.remove('active') αφαιρεί την κλάση 'active' από κάθε καρτέλα
    // Όταν μια καρτέλα δεν έχει την κλάση 'active', είναι κρυμμένη
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // ΒΗΜΑ 2: Αφαιρούμε το "active" από όλα τα κουμπιά
    // Αυτό σημαίνει ότι κανένα κουμπί δεν θα φαίνεται ως "επιλεγμένο"
    document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // ΒΗΜΑ 3: Εμφανίζουμε τη καρτέλα που επιλέχθηκε
    // getElementById() βρίσκει το στοιχείο με το συγκεκριμένο id
    // Το id είναι 'tab-' + tabName, π.χ. 'tab-courses' ή 'tab-grades'
    var selectedTab = document.getElementById('tab-' + tabName);
    // Ελέγχουμε αν βρέθηκε το στοιχείο (για να μην έχουμε σφάλμα)
    if (selectedTab) {
        // Προσθέτουμε την κλάση 'active' για να εμφανιστεί η καρτέλα
        selectedTab.classList.add('active');
    }
    
    // ΒΗΜΑ 4: Προσθέτουμε το "active" στο κουμπί που πατήθηκε
    // Πρώτα προσπαθούμε να βρούμε ποιο κουμπί πατήθηκε
    // Μπορεί να μας δοθεί ως παράμετρος (buttonElement)
    var activeButton = buttonElement;
    
    // Αν δεν μας δόθηκε, προσπαθούμε να το βρούμε από το event
    // (το event είναι το "γεγονός" του κλικ)
    if (!activeButton && typeof event !== 'undefined' && event.target) {
        activeButton = event.target;  // event.target είναι το στοιχείο που πατήθηκε
    }
    
    // Αν ακόμα δεν το βρήκαμε, το ψάχνουμε χειροκίνητα
    // Ψάχνουμε σε όλα τα κουμπιά και βρίσκουμε αυτό που έχει το σωστό tabName
    if (!activeButton) {
        document.querySelectorAll('.tab-button').forEach(btn => {
            // Ελέγχουμε αν το onclick attribute του κουμπιού περιέχει το tabName
            if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes("'" + tabName + "'")) {
                activeButton = btn;  // Βρήκαμε το σωστό κουμπί!
            }
        });
    }
    
    // Αν βρήκαμε το κουμπί, προσθέτουμε την κλάση 'active' για να φαίνεται ως επιλεγμένο
    if (activeButton) {
        activeButton.classList.add('active');
    }
    
    // ΒΗΜΑ 5: Αλλάζουμε το URL χωρίς να φορτώνουμε ξανά τη σελίδα
    // Αυτό είναι χρήσιμο γιατί:
    // - Ο χρήστης μπορεί να κάνει bookmark στη συγκεκριμένη καρτέλα
    // - Αν κάνει refresh, θα δει την ίδια καρτέλα
    // - Το URL αλλάζει σε κάτι σαν: ?tab=courses ή ?tab=grades
    window.history.pushState({}, '', '?tab=' + tabName);
}


// ============================================
// ΕΚΚΙΝΗΣΗ ΚΩΔΙΚΑ ΟΤΑΝ ΦΟΡΤΩΝΕΙ Η ΣΕΛΙΔΑ
// ============================================
// 
// Αυτό το κομμάτι κώδικα τρέχει αυτόματα όταν φορτώνει η σελίδα.
// Περιμένουμε να φορτωθεί όλο το HTML (το DOM) πριν τρέξουμε τον κώδικα.
//
// Τι κάνει:
// Καλεί τη συνάρτηση initCampusMap() για να δημιουργήσει τον χάρτη
// (αν η σελίδα έχει χάρτη, φυσικά)
//
// Σημείωση: Το DOMContentLoaded σημαίνει ότι όλο το HTML έχει φορτώσει,
// αλλά μπορεί να μην έχουν φορτώσει ακόμα όλες οι εικόνες. Αυτό είναι
// καλό γιατί ο κώδικας τρέχει γρήγορα.
document.addEventListener('DOMContentLoaded', function() {
    // Καλούμε τη συνάρτηση που δημιουργεί τον χάρτη
    initCampusMap();
});
